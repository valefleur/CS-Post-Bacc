### General Use Queries

# Show all plants grown by gardeners
SELECT g.fname, g.lname, pa.name FROM gardener g
INNER JOIN gardener_with_plot gp ON g.gardener_id = gp.gardener_id
INNER JOIN plot po ON gp.plot_id = po.plot_id
INNER JOIN plot_with_plant pwp ON po.plot_id = pwp.plot_id
INNER JOIN plant pa ON pwp.plant_id = pa.plant_id
ORDER BY g.lname;

# Find all gardeners in the Wilsonville garden
SELECT g.fname, g.lname FROM gardener g
INNER JOIN community_garden_with_gardener cgwg ON g.gardener_id = cgwg.gardener_id
INNER JOIN community_garden cg ON cgwg.community_id = cg.community_id
WHERE cg.location = "Wilsonville"
ORDER BY g.lname;

# Find all gardeners growing onions
SELECT g.fname, g.lname, pa.name FROM gardener g
INNER JOIN gardener_with_plot gp ON g.gardener_id = gp.gardener_id
INNER JOIN plot po ON gp.plot_id = po.plot_id
INNER JOIN plot_with_plant pwp ON po.plot_id = pwp.plot_id
INNER JOIN plant pa ON pwp.plant_id = pa.plant_id
WHERE pa.name = "Onion"
ORDER BY g.lname;

# Find all gardeners with more than one plot

# Find all gardens with roses
SELECT cg.name, cg.location FROM community_garden cg
INNER JOIN community_garden_with_gardener cgwg ON cg.community_id = cgwg.community_id
INNER JOIN gardener g ON cgwg.gardener_id = g.gardener_id
INNER JOIN gardener_with_plot gwp ON g.gardener_id = gwp.gardener_id
INNER JOIN plot po ON gwp.plot_id = po.plot_id
INNER JOIN plot_with_plant pwp ON po.plot_id = pwp.plot_id
INNER JOIN plant pa ON pwp.plant_id = pa.plant_id
WHERE pa.name = "Rose"
ORDER BY cg.location;

# Find all gardeners at the Wilsonville garden, ordered by Garden Name
SELECT cg.name, g.fname, g.lname FROM community_garden_with_gardener cgwg
INNER JOIN gardener g ON cgwg.gardener_id = g.gardener_id
INNER JOIN community_garden cg ON cgwg.community_id = cg.community_id
ORDER BY cg.name, g.lname;


#Find all gardeners who tend plot 1 in the Tualatin Hills garden.  BROKEN

#all gardeners in Tualatin Hills garden
(SELECT g.gardener_id, g.fname, g.lname FROM garden g
INNER JOIN community_garden_with_gardener cgwg ON g.gardener_id = cgwg.gardener_id
INNER JOIN community_garden cg ON cgwg.community_id = cg.community_id
WHERE cg.location = "Tualatin Hills") AS th_gardener

#all gardeners who tend exactly 1 plot
SELECT gar.gardener_id, gar.fname, gar.lname FROM garden gar 
INNER JOIN gardener_with_plot gwp ON gar.gardener_id = gwp.gardener_id 
INNER JOIN plot po ON gwp.plot_id = po.plot_id
WHERE COUNT(po.plot_id) = 1
GROUP BY gar.gardener_id;


SELECT gwp.gardener_id, COUNT(gwp.plot_id) FROM gardener_with_plot gwp GROUP BY gwp.gardener_id;



SELECT gar.gardener_id, gar.fname, gar.lname FROM gardener gar INNER JOIN
(SELECT g.fname, g.lname, g.gardener_id FROM gardener g
INNER JOIN community_garden_with_gardener cgwg ON cgwg.gardener_id = g.gardener_id
INNER JOIN community_garden cg ON cgwg.community_id = cg.community_id
WHERE cg.location = "Tualatin Hills"
GROUP BY g.lname) AS th_gardener
ON gar.gardener_id = th_gardener.gardener_id
INNER JOIN
(SELECT g.fname, g.lname, g.gardener_id FROM gardener g 
INNER JOIN gardener_with_plot gwp ON g.gardener_id = gwp.gardener_id
WHERE gwp.plot_id = 1) AS tends_plot_1
ON th_gardener.gardener_id = tends_plot_1.gardener_id






